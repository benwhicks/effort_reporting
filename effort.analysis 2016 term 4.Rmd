---
title: "Effort report trial - Year 12 Analysis"
author: "Ben Hicks"
date: "30 November 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
suppressWarnings(suppressPackageStartupMessages(library(ggplot2)))
suppressWarnings(suppressPackageStartupMessages(library(plotly)))
suppressWarnings(suppressPackageStartupMessages(library(dplyr)))
suppressWarnings(suppressPackageStartupMessages(library(tidyr)))
df <- unique(read.csv("effort_report_data.csv"))
df$Category <- factor(df$Category, levels = c("Diligence", "Engagement", "Behaviour"))
student.info <- read.csv("student.names.csv")
```

#### Whole School overview

Distribution of effort grades, comparing teachers with students. 

``` {r}
g1 <- ggplot(data = df, aes(x = Category, y = Score, color = Source)) + 
  geom_jitter(width = 0.3, alpha = 0.5) + 
  scale_color_brewer(palette = "Set2")+
  facet_wrap(~Source)
g1
```

By subject

``` {r fig.width = 15, fig.height = 10}
g1 + facet_wrap(~ Subject)
```

### Gender Analysis

Distribution of total effort score (Diligence + Engagement + Behaviour)

``` {r}
df.total <- df %>% spread(Category, Score)
df.total$Effort <- df.total$Diligence + df.total$Engagement + df.total$Behaviour
df.total <- subset(df.total, select = -c(Diligence, Engagement, Behaviour))
df.total <- merge(df.total, student.info)

df.total.wide <- df.total %>% spread(Source, Effort)


g2 <- ggplot(df.total.wide, aes(x = Teacher, y = Student, color = Gender)) + 
  geom_jitter(width = 0.1, alpha = 0.4, size = 4) + 
  coord_fixed(ratio = 1, xlim = c(3,15), ylim = c(3,15))
g2
```


Distribution by gender and source

``` {r}
g3 <- ggplot(df.total, aes(Effort, color = Gender)) + geom_density()
g3 + facet_wrap(~ Source)
```

Distribution by gender, source and subject
``` {r fig.height = 30}
g3 + facet_grid(Subject ~ Source, scales = "free")
```