{
    "collab_server" : "",
    "contents" : "effortPlot <- function(d, ctitle = \"Chart title\") {\n  # Recieves a long data frame and returns a ggplot historgram\n  # Their must be the following fields:\n  #  -- Score : The score (1 to 5, 5 being Outstanding)\n  #  -- Subject : The subject (such as 'English')\n  #  -- Source : Either Student or Teacher\n  #  -- Category : One of Diligence, Behaviour or Effort\n  require(ggplot2)\n  \n  # Setting up reording of subjects -- this needs to be refined \n  # to include Y12 subjects\n  slist <- c(\"English\",\n             \"Mathematics\",\n             \"Science\",\n             \"History\",\n             \"Geography\",\n             \"Cornerstone\",\n             \"Music\",\n             \"French\",\n             \"Design & Technology\",\n             \"Media Technology\",\n             \"Food Technology\",\n             \"Grahpics Technology\",\n             \"Visual Art\",\n             \"PDHPE\")\n  subject.orders <- data.frame(Subject = slist, Order = seq(length(slist)))\n  d <- merge(d, subject.orders)\n  forOrder <- unique(data.frame(Subject = d$Subject, Order = d$Order))\n  forOrder <- forOrder[order(forOrder$Order),]\n  facetOrder <- forOrder$Subject\n  d$Subject <- factor(d$Subject, levels = facetOrder)\n  \n  d$Category <- factor(d$Category, levels = c(\"Diligence\", \"Engagement\", \"Behaviour\"))\n  \n  # Creating the actual plot\n  g <- ggplot(data = d, \n              aes(x = Category, y = Score, fill = Source)) + \n    geom_bar(stat = \"identity\", position = \"dodge\", width = 0.6) +\n    ggtitle(ctitle) +\n    guides(fill = guide_legend(title = NULL)) +\n    theme(text = element_text(family = \"Helvetica\", size = 10)) +\n    facet_grid(Subject ~ .) +\n    coord_cartesian(ylim = c(1,5)) +\n    scale_y_discrete(name = \"Effort rating\", \n                     limits = c(\"Unsatisfactory\", \"Fair\", \"Good\", \"Very Good\", \"Outstanding\")) +\n    scale_fill_manual(values = c(\"skyblue\",\"navy\"))\n  return(g)\n}\n\noverallEffortPlot <- function(d, ctitle = \"Overall Effort\") {\n  require(dplyr)\n  d <- summarise(group_by(d, Source, Category), mean(Score))\n  names(d) <- c(\"Source\", \"Category\", \"Score\")\n  d$Category <- factor(d$Category, levels = c(\"Diligence\", \"Engagement\", \"Behaviour\"))\n  # creating the plot\n  g <- ggplot(data = d, aes(x = Category, y = Score, fill = Source)) +\n    geom_bar(stat = \"identity\", position = \"dodge\", width = 0.6) +\n    ggtitle(ctitle) +\n    guides(fill = guide_legend(title = NULL)) +\n    theme(text = element_text(family = \"Helvetica\", size = 10)) +\n    coord_cartesian(ylim = c(1,5)) +\n    scale_y_discrete(name = \"Effort rating\", \n                     limits = c(\"Unsatisfactory\", \"Fair\", \"Good\", \"Very Good\", \"Outstanding\")) +\n    scale_fill_manual(values = c(\"skyblue\",\"navy\"))\n  return(g)\n}\n",
    "created" : 1477963757379.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "399721162",
    "id" : "8F915DD4",
    "lastKnownWriteTime" : 1478464207,
    "last_content_update" : 1478464207686,
    "path" : "~/Documents/Data Analysis/R/Effort Reporting/effort.functions.R",
    "project_path" : "effort.functions.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}